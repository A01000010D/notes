<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monolith Note</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@40400&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #000;
            --text-color: #FFF;
            --line-number-color: #555; /* Slightly darker gray for line numbers */
            --border-color: #333; /* For subtle separators */
        }

        body {
            background-color: var(--bg-color);
            margin: 0;
            overflow: hidden;
            height: 100vh;
            display: flex;
            font-family: 'Roboto Mono', monospace; /* More common monospace, with fallback */
            font-size: 1.1em; /* Slightly adjusted size */
            line-height: 1.6; /* Improved line spacing for readability */
            color: var(--text-color); /* Set default text color */
        }

        .container {
            display: flex;
            width: 100%;
            height: 100%;
            border-left: 1px solid var(--border-color); /* Add a left border for a "terminal" feel */
        }

        /* Custom Scrollbar Styles (for Webkit browsers like Chrome/Safari) */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-color);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--line-number-color);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #777;
        }

        /* Line numbers area */
        #lineNumbers {
            flex-shrink: 0;
            padding: 20px 10px 20px 15px; /* Adjusted padding for better visual balance */
            background-color: var(--bg-color);
            color: var(--line-number-color);
            text-align: right;
            user-select: none;
            overflow: hidden;
            border-right: 1px solid var(--border-color); /* Subtle separator */
            font-size: 0.9em; /* Slightly smaller font for numbers */
            line-height: inherit; /* Inherit line height for consistent spacing */
        }

        #lineNumbers div {
            height: 1.6em; /* Match line-height of notePad for perfect sync */
        }

        /* Main typing area */
        #notePad {
            flex-grow: 1;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            border: none;
            resize: none;
            box-sizing: border-box;
            outline: none;
            font-family: inherit;
            font-size: inherit;
            line-height: inherit;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
            text-shadow: 0 0 1px rgba(255, 255, 255, 0.1); /* Subtle text shadow */
            caret-color: var(--text-color); /* Blinking cursor color */
        }

        /* Placeholder style for better user guidance */
        #notePad::placeholder {
            color: var(--line-number-color);
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="lineNumbers"></div>
        <textarea id="notePad" placeholder="Start typing your note here..."></textarea>
    </div>

    <script>
        const notePad = document.getElementById('notePad');
        const lineNumbers = document.getElementById('lineNumbers');

        function updateLineNumbers() {
            // Ensure at least one line number is always displayed
            const text = notePad.value;
            const lines = text.split('\n');
            const numberOfLines = Math.max(lines.length, 1); // At least 1 line
            const numbersHtml = Array.from({ length: numberOfLines }, (_, i) => `<div>${i + 1}</div>`).join('');
            lineNumbers.innerHTML = numbersHtml;

            // Sync scroll immediately after updating numbers, in case content reflows
            syncScroll();
        }

        function syncScroll() {
            lineNumbers.scrollTop = notePad.scrollTop;
        }

        // Handles Tab key to insert a tab character instead of changing focus
        notePad.addEventListener('keydown', (e) => {
            if (e.key === 'Tab') {
                e.preventDefault(); // Prevent default tab behavior (focusing next element)
                const start = notePad.selectionStart;
                const end = notePad.selectionEnd;

                // Insert tab character
                notePad.value = notePad.value.substring(0, start) + '\t' + notePad.value.substring(end);

                // Move cursor to after the inserted tab
                notePad.selectionStart = notePad.selectionEnd = start + 1;

                updateLineNumbers(); // Update line numbers after inserting tab
            }
        });

        document.addEventListener('DOMContentLoaded', () => {
            const savedNote = localStorage.getItem('monolithNote'); // Changed key to avoid conflicts
            if (savedNote) {
                notePad.value = savedNote;
            } else {
                // Pre-fill with a helpful tip if empty
                notePad.value = "Welcome to Monolith Note!\n\nStart typing your thoughts here. Your work saves automatically.\n\nPress Tab for indentation.";
            }
            updateLineNumbers(); // Initial update
        });

        notePad.addEventListener('input', () => {
            updateLineNumbers();
            localStorage.setItem('monolithNote', notePad.value); // Changed key
        });

        notePad.addEventListener('scroll', syncScroll);
        window.addEventListener('resize', updateLineNumbers); // Recalculate on resize
    </script>
</body>
</html>
